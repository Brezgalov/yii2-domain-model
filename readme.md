## Для чего этот репозиторй?

### Лирика

Этот репозиторий содержит классы и интерфейсы, каркас (framework) для структурирования кода приложения. 
Он вдохновлен подходом Domain Driven Development.

Основная цель этого репозитория - помочь разработчикам писать код так, чтобы с годами 
их приложение так же легко поддерживалось и масштабировалось, как и на старте. 
Новичкам было очевидно для чего нужен конкретный кусок кода и в какой фиче он используется.

Я постарался подойти к доменной модели так, чтобы она была в принципе и 
чтобы работа с ней не занимала много времени и не тормозила разработку.

Этот пакет довольно сильно завязан на движке и нарушает ряд правил каноничного DDD в угоду скорости.
Но если делать все по правилам - работа будет идти так долго, что бизнес вместо вас наймет разработчика, 
который не следует никаким правилам вовсе.
Это будет вредно и для вас и для бизнеса. 

К сути!

## Как это работает?

###Модель

Чтобы было проще начнем знакомство на примере. 
Допустим мы хотим реализовать подтверждение телефона пользователя. 
Мы знаем что у пользователя есть телефон и должна быть отметка о том, что телефон подтвержден.

Следуя DDD мы должны были бы создать модель **Пользователь** такого вида:

    class UserDM extends BasicDomainModel
    {
        /**
         * @var integer
         */
        public $id;

        /**
        * @var string
        */
        public $phone;
    
        /**
         * @var string
         */
        public $phone_confirmed_mark;
    }

На практике, прописывать перенос полей из БД в модель и обратно - довольно затратная по человеко-часам операция. 
Следование DDD в этом аспекте увеличит срок разработки и бизнес будет недоволен.
Я предлагаю пойти на компромис и оборачивать один или несколько DAO в модели, если это возможно.

>*Поля модели оставляю публичными, опять же для упрощения. 
Я полагаю, что программисты не будут использовать эти поля "не правильно", потому что такой код
будет отсеиваться на код-ревью, а сами сотрудники - обучаться.*

    class UserProfileDM extends BasicDomainModel
    {
        /**
        * @var UsersDao
        */
        public $user;
    }

### Репозиторий (чтение)

Мы будем подтверждать телефон уже существующего пользователя. 
Нам понадобится способ наполнить модель данными. 
Создадим для этого класс-репозиторий. 

    class UserProfileDMRepository extends BasicRepository implements IDomainModelRepository
    {
        /**
        * @var integer
        */
        public $id;
    
        /**
         * @var UsersDaoRepository
         */
        public $usersDaoRepo;
    
        /**
         * UserProfileDMRepository constructor.
         * @param array $config
         */
        public function __construct($config = [])
        {
            parent::__construct($config);
    
            if (empty($this->usersDaoRepo)) {
                $this->usersDaoRepo = new UsersDaoRepository();
            }
        }
    
        /**
         * @return array[]
         */
        public function rules()
        {
            return [
                [['id'], 'required', 'message' => 'Укажите ID пользователя для отображения профиля'],
            ];
        }
    
        /**
         * @return UserProfileDM
         * @throws ErrorException
         */
        public function loadDomainModel()
        {
            $model = new UserProfileDM();
    
            $daoRepo = clone $this->usersDaoRepo;
            $daoRepo->id = $this->id;
    
            $userDao = $daoRepo->getQuery()->one();
            if (empty($userDao)) {
                ErrorException::throwAsModelError('id', 'Не удается найти профиль пользователя');
            }
    
            $model->user = $userDao;
    
            return $model;
        }
    }

>**DAO** - Data Access Object. Как правило, в Yii в роли объекта доступа к данным выступает **ActiveRecord**

> **UsersDaoRepository** реализует **IDaoRepository** и служит для поиска DAO по каким-либо параметрам, в нашем случае - по id

### Логика

Теперь мы хотим реализовать подтверждение телефона. 

### Сервис (Подключение к контроллеру)

### Unit of Work (Запись изменений)

### Форматирование ответа

## Продвинутые практики

### Отложенные события

### Кросс-доменное взаимодействие

